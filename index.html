<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Join Telegram</title>
<style>
  body{font-family:system-ui, -apple-system; background:#0b0b0d; color:#fff; margin:0; min-height:100vh;
       display:flex; align-items:center; justify-content:center; padding:20px}
  .card{max-width:520px;text-align:center}
  button, a{display:inline-block;padding:14px 18px;border-radius:12px;border:none;background:#e63946;color:#fff;
           text-decoration:none;font-weight:700;margin-top:12px;cursor:pointer;transition:transform 0.1s}
  button:active, a:active{transform:scale(0.95)}
  .hint{color:#c9c9d3;margin-top:12px;font-size:14px}
  img.qr{width:200px;height:200px;margin-top:18px;border-radius:12px}
  .holding{background:#c92a36;animation:pulse 0.5s infinite alternate}
  @keyframes pulse{to{opacity:0.8}}
  .timer{font-size:24px;font-weight:bold;color:#e63946;margin-top:8px}
  
  /* Safari-style modal */
  .safari-modal{
    position:fixed;
    top:0;
    left:0;
    right:0;
    bottom:0;
    background:rgba(0,0,0,0.6);
    display:none;
    align-items:flex-end;
    justify-content:center;
    z-index:1000;
    animation:fadeIn 0.3s ease;
  }
  .safari-modal.show{display:flex}
  
  @keyframes fadeIn{from{opacity:0}}
  @keyframes slideUp{from{transform:translateY(100%)}}
  
  .safari-sheet{
    background:#fff;
    border-radius:16px 16px 0 0;
    width:100%;
    max-width:500px;
    padding:20px;
    animation:slideUp 0.3s ease;
    color:#000;
  }
  
  .safari-header{
    text-align:center;
    padding-bottom:16px;
    border-bottom:1px solid #e5e5e5;
  }
  
  .safari-header h3{
    margin:0;
    font-size:18px;
    font-weight:600;
  }
  
  .safari-header p{
    margin:8px 0 0 0;
    font-size:13px;
    color:#666;
  }
  
  .safari-options{
    padding:16px 0;
  }
  
  .safari-option{
    padding:16px;
    background:#f8f8f8;
    border-radius:12px;
    margin-bottom:12px;
    display:flex;
    align-items:center;
    gap:12px;
    cursor:pointer;
    transition:background 0.2s;
  }
  
  .safari-option:hover{
    background:#e8e8e8;
  }
  
  .safari-option-icon{
    width:32px;
    height:32px;
    background:#007AFF;
    border-radius:8px;
    display:flex;
    align-items:center;
    justify-content:center;
    color:#fff;
    font-weight:bold;
    font-size:18px;
  }
  
  .safari-option-text{
    text-align:left;
    flex:1;
  }
  
  .safari-option-text strong{
    display:block;
    font-size:16px;
    margin-bottom:2px;
  }
  
  .safari-option-text span{
    font-size:13px;
    color:#666;
  }
  
  .safari-cancel{
    width:100%;
    padding:16px;
    background:#f8f8f8;
    border:none;
    border-radius:12px;
    font-size:16px;
    font-weight:600;
    cursor:pointer;
  }
</style>
</head>
<body>
  <div class="card">
    <h1>Join our Telegram</h1>
    <p class="hint">Connecting you to Telegram...</p>
    <div id="actions">
      <button id="openTg">Join Telegram</button>
      <div class="timer" id="timer"></div>
      <div class="hint" id="appHint"></div>
    </div>
    <div id="qrWrap"></div>
  </div>

  <!-- Safari-style modal -->
  <div class="safari-modal" id="safariModal">
    <div class="safari-sheet">
      <div class="safari-header">
        <h3>"t.me" wants to open "Telegram"</h3>
        <p>realpyroservice</p>
      </div>
      <div class="safari-options">
        <div class="safari-option" id="openInTelegram">
          <div class="safari-option-icon">ðŸ“±</div>
          <div class="safari-option-text">
            <strong>Open in Telegram</strong>
            <span>Join the channel</span>
          </div>
        </div>
      </div>
      <button class="safari-cancel" id="cancelBtn">Cancel</button>
    </div>
  </div>

<script>
(function(){
  var tgApp = "tg://resolve?domain=realpyroservice";
  var webUrl = "https://t.me/realpyroservice";
  var openBtn = document.getElementById('openTg');
  var timerDisplay = document.getElementById('timer');
  var safariModal = document.getElementById('safariModal');
  var cancelBtn = document.getElementById('cancelBtn');
  var openInTelegram = document.getElementById('openInTelegram');

  function showSafariPrompt(){
    safariModal.classList.add('show');
  }

  function hideSafariPrompt(){
    safariModal.classList.remove('show');
  }

  function openTelegram(){
    hideSafariPrompt();
    timerDisplay.textContent = 'Opening...';
    var now = Date.now();
    window.location = tgApp;
    setTimeout(function(){
      if (Date.now() - now > 2000) return;
      window.location = webUrl;
    }, 1000);
  }

  // Handle Safari modal interactions
  openInTelegram.addEventListener('click', function(){
    openTelegram();
  });

  cancelBtn.addEventListener('click', function(){
    hideSafariPrompt();
    timerDisplay.textContent = '';
  });

  safariModal.addEventListener('click', function(e){
    if(e.target === safariModal){
      hideSafariPrompt();
    }
  });

  // Button hold functionality
  var holdTimer;
  var holdDuration = 2000;
  var startTime;
  var countdownInterval;

  function startHold(){
    openBtn.classList.add('holding');
    startTime = Date.now();
    
    countdownInterval = setInterval(function(){
      var elapsed = Date.now() - startTime;
      var remaining = Math.ceil((holdDuration - elapsed) / 1000);
      if(remaining > 0){
        timerDisplay.textContent = remaining;
      }
    }, 100);

    holdTimer = setTimeout(function(){
      clearInterval(countdownInterval);
      timerDisplay.textContent = '';
      openBtn.classList.remove('holding');
      showSafariPrompt();
    }, holdDuration);
  }

  function cancelHold(){
    openBtn.classList.remove('holding');
    clearTimeout(holdTimer);
    clearInterval(countdownInterval);
    timerDisplay.textContent = '';
  }

  openBtn.addEventListener('touchstart', function(e){
    e.preventDefault();
    startHold();
  });

  openBtn.addEventListener('touchend', function(e){
    e.preventDefault();
    cancelHold();
  });

  openBtn.addEventListener('touchcancel', function(e){
    e.preventDefault();
    cancelHold();
  });

  openBtn.addEventListener('mousedown', function(e){
    e.preventDefault();
    startHold();
  });

  openBtn.addEventListener('mouseup', function(e){
    e.preventDefault();
    cancelHold();
  });

  openBtn.addEventListener('mouseleave', function(e){
    cancelHold();
  });

  // In-app browser detection
  var ua = navigator.userAgent || navigator.vendor || "";
  var isTikTok = /TikTok/i.test(ua);
  var isInstagram = /Instagram/i.test(ua);
  var isInApp = isTikTok || isInstagram || /FBAN|FBAV|Line|LinkedInApp/i.test(ua);
  
  if(isInApp){
    var hint = document.getElementById('appHint');
    hint.innerText = "Looks like you're in an app browser. Tap the â‹¯ menu and choose 'Open in Safari' or 'Open in browser'.";
    var qrImg = document.createElement('img');
    qrImg.className = 'qr';
    qrImg.src = "https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=" + encodeURIComponent(webUrl);
    document.getElementById('qrWrap').appendChild(qrImg);
  }

  // Auto-trigger on page load
  window.addEventListener('load', function(){
    if(isInApp){
      return; // Don't auto-trigger in in-app browsers
    }
    
    setTimeout(function(){
      startHold();
    }, 800);
  });
})();
</script>
</body>
</html>
